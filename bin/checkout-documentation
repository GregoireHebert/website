#!/usr/bin/env node

const {docPagesDirectory, current, versions} = require('../constants');
const {getPrefixedVersion} = require('../src/lib/versionHelper');
const {execSync} = require('child_process');

execSync(`rm -rf ${docPagesDirectory}`);

console.info(`checking out the stable version in ${docPagesDirectory}${current}`);
execSync(`git clone https://github.com/api-platform/docs.git ${docPagesDirectory}${current}`);
console.info(`current stable version checked out.`);

versions.forEach(version => {
    const versionDirectory = getPrefixedVersion(version);

    console.info(`checking out the ${version} version in ${docPagesDirectory}${versionDirectory}/ directory`);
    execSync(`cp -R ${docPagesDirectory}${current} ${docPagesDirectory}${versionDirectory}/`);
    execSync(`cd ${docPagesDirectory}${versionDirectory} && git checkout ${version}`);
    console.info(`${version} version checked out.`);
});
